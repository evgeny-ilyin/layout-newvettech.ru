@use '../../abstracts' as *;

.accordion {
	display: flex;
	flex-direction: column;
	gap: 16px;
	margin-bottom: 30px;

	// .accordion__item
	&__item {
		--accordion-bg: var(--color-white);
		--trigger-border-radius: 35px;
		color: var(--color-primary);
		background: var(--accordion-bg);
		border: 2px solid var(--color-primary);
		border-radius: var(--trigger-border-radius);
		transition: all $transition-default;

		&.is-opened {
			--accordion-bg: var(--color-primary);
			color: var(--color-white);
		}
	}

	// .accordion__header
	&__header {
		width: 100%;
		// display: flex;
		// align-items: center;
		// height: 50px;
		// padding: 10px 20px 10px 25px;
		// font-size: rem(18);
		// font-weight: var(--font-weight-medium);
		// line-height: 1;
	}

	// .accordion__header-wrapper
	&__header-wrapper {
		display: flex;
		flex-direction: column;
		align-items: flex-start;

		@include resp-from(xm) {
			flex-direction: row;
			align-items: normal;
		}
	}

	// .accordion__content
	&__content {
		--color-link: var(--color-white);
		--color-link-hover: var(--color-white);
		position: relative;
		max-height: 0;
		overflow: hidden;
		color: var(--color-white);
		transition: max-height $transition-default;

		* {
			font-size: rem(17);
			line-height: 1.3;
		}

		div {
			padding: 0 30px 27px 58px;
		}
	}

	@include resp-from(md) {
		margin-bottom: 38px;
	}
}

.js-accordion {
	--min-height: 46px;
	position: relative;

	// .js-accordion-trigger
	.js-accordion-trigger {
		--arrow-color: var(--color-primary);
		--arrow-width: 14px;
		--arrow-margin: -9px 0 0;
		display: flex;
		align-items: center;
		gap: 20px;
		position: relative;
		width: 100%;
		height: auto;
		min-height: var(--min-height);
		padding: 10px 20px 10px 25px;
		font-size: rem(18);
		font-weight: var(--font-weight-medium);
		line-height: 1;
		text-align: left;
		color: currentcolor;
		background: transparent;
		border: 0;
		border-radius: var(--trigger-border-radius);
		cursor: pointer;

		&::before {
			content: '';
			flex: 0 0 auto;
			transform: rotate(225deg);
			width: var(--arrow-width, 14px);
			height: var(--arrow-width, 14px);
			margin: var(--arrow-margin, 20px);
			border-top: 2px solid var(--arrow-color, currentcolor);
			border-left: 2px solid var(--arrow-color, currentcolor);
			transition: all $transition-default;
		}

		// @include no-tap-highlight;
	}

	.is-opened {
		.js-accordion-trigger {
			--arrow-margin: 8px 0 0;
			user-select: none;

			&::before {
				transform: rotate(225deg) scale(-1);
				border-color: var(--color-white);
			}
		}
	}
}

// расположение элементов по окружности только для десктопа
.accordion-circle {
	// .accordion-circle__center
	&__center {
		display: none;
	}

	@include resp-from(desktop) {
		--radius-small: min(12.5vw, 225px);
		--radius-mid: min(16vw, 275px);
		--radius-big: min(25vw, 447px);
		--radius-item: min(14vw, 250px);
		--min-height: 42px;
		--crop-height: 85px;
		--img-size: min(21vw, 380px);
		display: grid;
		grid-template-areas: 'layer';
		width: calc(2 * var(--radius-big));
		height: calc(2 * var(--radius-big) - 2 * var(--crop-height));
		margin: 0 auto;
		background-image:
			url('../img/accordion-circle-1.svg'), url('../img/accordion-circle-2.svg'), url('../img/accordion-circle-3.svg');
		background-repeat: no-repeat, no-repeat, no-repeat;
		background-position: center, center, center;
		background-size: calc(2 * var(--radius-small)), calc(2 * var(--radius-mid)), calc(2 * var(--radius-big));
		justify-items: center;

		/* stylelint-disable-next-line selector-class-pattern */
		.accordion__item {
			--trigger-border-radius: 25px;
			--width: 450px;
			// Decimal value, 0-1 based on the child's index.
			--d: calc(var(--i) / var(--total));
			// Offset to get better starting placement on the circle
			--r-offset: -0.2turn;
			// Full circle
			--r-amount: 1turn;
			// Rotation based on the decimal and r modifiers
			--r: calc((var(--r-amount) * var(--d)) + var(--r-offset));
			// Rotate, transform out, then negative rotation so the content appears upright
			--transform: rotate(var(--r)) translate(var(--radius-item)) rotate(calc(-1 * var(--r)));
			display: grid;
			grid-area: layer;
			position: absolute;
			top: calc(var(--radius-big) - var(--crop-height) - var(--min-height) / 2);
			transform: var(--transform);
			z-index: var(--z);
			width: var(--width);
			margin-left: calc(var(--shift) * var(--width));
			place-items: center;
		}

		.js-accordion-trigger {
			flex-direction: var(--fd, row);
			padding: 5px 20px;
			font-size: rem(20);

			&::before {
				--arrow-width: 13px;
				--arrow-margin: 0;
				display: block;
				background: currentcolor;
				border: 0;
				border-radius: 50%;
			}
		}

		// .accordion-circle__center
		&__center {
			display: block;

			img {
				width: var(--img-size);
				border-radius: 50%;
			}

			@include flex-center;
		}
	}
}
